<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Pop_Ecol_KMUTT: Population models</title>



<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-06-12"/>
<meta property="article:created" itemprop="dateCreated" content="2022-06-12"/>
<meta name="article:author" content="Matt Grainger"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Pop_Ecol_KMUTT: Population models"/>
<meta property="og:type" content="article"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Pop_Ecol_KMUTT"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Pop_Ecol_KMUTT: Population models"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","output","date"]}},"value":[{"type":"character","attributes":{},"value":["Population models"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Matt Grainger"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["06-12-2022"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["Population-models1_files/anchor-4.2.2/anchor.min.js","Population-models1_files/bowser-1.9.3/bowser.min.js","Population-models1_files/distill-2.2.21/template.v2.js","Population-models1_files/figure-html5/add a stochastic term eg rmax is stochastically influenced by environment-1.png","Population-models1_files/figure-html5/add a stochastic term eg rmax is stochastically influenced by environment-2.png","Population-models1_files/figure-html5/Add stochastic term-1.png","Population-models1_files/figure-html5/Add stochastic term-2.png","Population-models1_files/figure-html5/density dependent logistic growth-1.png","Population-models1_files/figure-html5/Exponential growth model-1.png","Population-models1_files/figure-html5/Iterative approach using discrete model formulation-1.png","Population-models1_files/figure-html5/Make sure nothing silly happens-1.png","Population-models1_files/figure-html5/Stochastic-1.png","Population-models1_files/figure-html5/STOCHASTIC PROCESS ORIENTED MODELS-1.png","Population-models1_files/figure-html5/unnamed-chunk-1-1.png","Population-models1_files/figure-html5/unnamed-chunk-2-1.png","Population-models1_files/jquery-1.11.3/jquery.min.js","Population-models1_files/jquery-3.6.0/jquery-3.6.0.js","Population-models1_files/jquery-3.6.0/jquery-3.6.0.min.js","Population-models1_files/jquery-3.6.0/jquery-3.6.0.min.map","Population-models1_files/popper-2.6.0/popper.min.js","Population-models1_files/tippy-6.2.7/tippy-bundle.umd.min.js","Population-models1_files/tippy-6.2.7/tippy-light-border.css","Population-models1_files/tippy-6.2.7/tippy.css","Population-models1_files/tippy-6.2.7/tippy.umd.min.js","Population-models1_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
        var fn = $(this).children()[0]
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Population models","authors":[{"author":"Matt Grainger","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-06-12T00:00:00.000+02:00","citationText":"Grainger, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Pop_Ecol_KMUTT</a>
<a href="../../schedule.html">schedule</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">posts</a>
<span class="nav-dropdown-header">slides</span>
<a href="../../slides/What_is_pop_ecol/What-is-population-ecology.html">What is population ecology</a>
<a href="../../about.html">about</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Population models</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  Matt Grainger
  
<br/>06-12-2022
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#exponential growth model</span>
<span class='co'>#initial population size</span>
<span class='va'>N0</span><span class='op'>&lt;-</span><span class='fl'>100</span>
<span class='co'>#population growth rate</span>
<span class='va'>r</span><span class='op'>&lt;-</span><span class='fl'>0.1</span>
<span class='co'>#years we are simulating</span>
<span class='cn'>T</span><span class='op'>&lt;-</span><span class='fl'>10</span>
<span class='co'>#method 1: use the explicit formula directly </span>
<span class='co'>#first generate a list of time indices</span>
<span class='va'>t</span><span class='op'>&lt;-</span><span class='fl'>0</span><span class='op'>:</span><span class='cn'>T</span> 
<span class='co'>#now calculate N at each time</span>
<span class='va'>N</span><span class='op'>&lt;-</span><span class='va'>N0</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span>
<span class='co'>#make it pretty</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>t</span>,N<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    t        N
1   0 100.0000
2   1 110.5171
3   2 122.1403
4   3 134.9859
5   4 149.1825
6   5 164.8721
7   6 182.2119
8   7 201.3753
9   8 222.5541
10  9 245.9603
11 10 271.8282</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>N</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/Exponential%20growth%20model-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>N0</span><span class='op'>&lt;-</span><span class='fl'>100</span>
<span class='va'>r.mean</span><span class='op'>&lt;-</span><span class='fl'>0.10</span>
<span class='va'>r.sd</span><span class='op'>&lt;-</span><span class='fl'>0.30</span>
<span class='va'>r</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='cn'>T</span>,<span class='va'>r.mean</span>,<span class='va'>r.sd</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>r.mean</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>r.mean</span><span class='op'>+</span><span class='va'>r.sd</span>,col<span class='op'>=</span><span class='st'>"blue"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>r.mean</span><span class='op'>-</span><span class='va'>r.sd</span>,col<span class='op'>=</span><span class='st'>"blue"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Population-models1_files/figure-html5/Add%20stochastic%20term-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#now use this in place of the constant r</span>
<span class='va'>t</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span>dim<span class='op'>=</span><span class='cn'>T</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#first element is initial value</span>
<span class='va'>N</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N0</span>
<span class='va'>t</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fl'>0</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='cn'>T</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>=</span><span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span>
<span class='op'>}</span>
<span class='co'>#make it pretty</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>t</span>,N<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    t        N
1   0 100.0000
2   1  73.4713
3   2 125.7968
4   3 177.1049
5   4 301.5335
6   5 322.1165
7   6 347.1691
8   7 166.8974
9   8 160.4016
10  9 176.2899
11 10 234.2313</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>N</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/Add%20stochastic%20term-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># N to be integer if we want. </span>
<span class='va'>N0</span><span class='op'>&lt;-</span><span class='fl'>10</span>
<span class='va'>r.mean</span><span class='op'>&lt;-</span><span class='fl'>0.0</span>
<span class='va'>r.sd</span><span class='op'>&lt;-</span><span class='fl'>0.8</span>
<span class='va'>r</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='cn'>T</span>,<span class='va'>r.mean</span>,<span class='va'>r.sd</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>r.mean</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>r.mean</span><span class='op'>+</span><span class='va'>r.sd</span>,col<span class='op'>=</span><span class='st'>"blue"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>r.mean</span><span class='op'>-</span><span class='va'>r.sd</span>,col<span class='op'>=</span><span class='st'>"blue"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/Make%20sure%20nothing%20silly%20happens-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#now use this in place of the constant r</span>
<span class='va'>t</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span>dim<span class='op'>=</span><span class='cn'>T</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#first element is initial value</span>
<span class='va'>N</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N0</span>
<span class='va'>t</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fl'>0</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='cn'>T</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>,<span class='fl'>0</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>*</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'>#makes N= 0 if falls below 2</span>
  
  <span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>=</span><span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span>
<span class='op'>}</span>
</code></pre>
</div>
<pre><code>[1] 8
[1] 16
[1] 20
[1] 15
[1] 31
[1] 32
[1] 9
[1] 4
[1] 4
[1] 2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#make it pretty</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>t</span>,N<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    t  N
1   0 10
2   1  8
3   2 16
4   3 20
5   4 15
6   5 31
7   6 32
8   7  9
9   8  4
10  9  4
11 10  2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>N</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/Stochastic-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#continuous growth model</span>
<span class='co'>#parameters</span>
<span class='cn'>T</span><span class='op'>&lt;-</span><span class='fl'>50</span>
<span class='va'>N0</span><span class='op'>&lt;-</span><span class='fl'>100</span>
<span class='va'>K</span><span class='op'>&lt;-</span><span class='fl'>500</span>
<span class='va'>rmax</span><span class='op'>&lt;-</span><span class='fl'>0.2</span>
<span class='va'>C</span><span class='op'>&lt;-</span><span class='va'>K</span><span class='op'>/</span><span class='va'>N0</span><span class='op'>-</span><span class='fl'>1</span> 
<span class='co'>#first generate a list of time indices</span>
<span class='va'>t</span><span class='op'>&lt;-</span><span class='fl'>0</span><span class='op'>:</span><span class='cn'>T</span> 
<span class='va'>N</span><span class='op'>&lt;-</span><span class='va'>K</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='va'>C</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>rmax</span><span class='op'>*</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#make it pretty</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>t</span>,N<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    t        N
1   0 100.0000
2   1 116.9612
3   2 135.8223
4   3 156.4824
5   4 178.7428
6   5 202.3048
7   6 226.7803
8   7 251.7132
9   8 276.6120
10  9 300.9880
11 10 324.3928
12 11 346.4493
13 12 366.8724
14 13 385.4770
15 14 402.1749
16 15 416.9626
17 16 429.9046
18 17 441.1143
19 18 450.7368
20 19 458.9332
21 20 465.8692
22 21 471.7060
23 22 476.5947
24 23 480.6734
25 24 484.0651
26 25 486.8778
27 26 489.2051
28 27 491.1271
29 28 492.7121
30 29 494.0173
31 30 495.0912
32 31 495.9738
33 32 496.6988
34 33 497.2940
35 34 497.7823
36 35 498.1829
37 36 498.5113
38 37 498.7805
39 38 499.0011
40 39 499.1819
41 40 499.3300
42 41 499.4513
43 42 499.5507
44 43 499.6321
45 44 499.6987
46 45 499.7533
47 46 499.7980
48 47 499.8346
49 48 499.8646
50 49 499.8891
51 50 499.9092</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>N</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/density%20dependent%20logistic%20growth-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#### </span>
<span class='cn'>T</span><span class='op'>&lt;-</span><span class='fl'>50</span>
<span class='va'>N0</span><span class='op'>&lt;-</span><span class='fl'>100</span>
<span class='va'>K</span><span class='op'>&lt;-</span><span class='fl'>500</span>
<span class='va'>rmax</span><span class='op'>&lt;-</span><span class='fl'>0.2</span>

<span class='va'>t</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span>dim<span class='op'>=</span><span class='cn'>T</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#first element is initial value</span>
<span class='va'>N</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N0</span>
<span class='va'>t</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fl'>0</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='cn'>T</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='va'>rmax</span><span class='op'>*</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>/</span><span class='va'>K</span><span class='op'>)</span>
  <span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>=</span><span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span>
<span class='op'>}</span>
<span class='co'>#make it pretty</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>t</span>,N<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    t        N
1   0 100.0000
2   1 116.0000
3   2 133.8176
4   3 153.4183
5   4 174.6870
6   5 197.4182
7   6 221.3123
8   7 245.9831
9   8 270.9766
10  9 295.8006
11 10 319.9616
12 11 343.0037
13 12 364.5438
14 13 384.2957
15 14 402.0816
16 15 417.8301
17 16 431.5633
18 17 443.3772
19 18 453.4193
20 19 461.8675
21 20 468.9124
22 21 474.7433
23 22 479.5395
24 23 483.4642
25 24 486.6620
26 25 489.2584
27 26 491.3606
28 27 493.0586
29 28 494.4276
30 29 495.5297
31 30 496.4157
32 31 497.1275
33 32 497.6987
34 33 498.1568
35 34 498.5241
36 35 498.8184
37 36 499.0542
38 37 499.2430
39 38 499.3941
40 39 499.5152
41 40 499.6120
42 41 499.6896
43 42 499.7516
44 43 499.8013
45 44 499.8410
46 45 499.8728
47 46 499.8982
48 47 499.9186
49 48 499.9349
50 49 499.9479
51 50 499.9583</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>N</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/Iterative%20approach%20using%20discrete%20model%20formulation-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='cn'>T</span><span class='op'>&lt;-</span><span class='fl'>50</span>
<span class='va'>N0</span><span class='op'>&lt;-</span><span class='fl'>100</span>
<span class='va'>K</span><span class='op'>&lt;-</span><span class='fl'>500</span>
<span class='va'>rmax.mean</span><span class='op'>&lt;-</span><span class='fl'>0.2</span>
<span class='va'>rmax.sd</span><span class='op'>&lt;-</span><span class='fl'>0.2</span>
<span class='va'>rmax</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='cn'>T</span>,<span class='va'>rmax.mean</span>,<span class='va'>rmax.sd</span><span class='op'>)</span>
<span class='va'>t</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span>dim<span class='op'>=</span><span class='cn'>T</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>rmax</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>rmax.mean</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>rmax.mean</span><span class='op'>+</span><span class='va'>rmax.sd</span>,col<span class='op'>=</span><span class='st'>"blue"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>rmax.mean</span><span class='op'>-</span><span class='va'>rmax.sd</span>,col<span class='op'>=</span><span class='st'>"blue"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Population-models1_files/figure-html5/add%20a%20stochastic%20term%20eg%20rmax%20is%20stochastically%20influenced%20by%20environment-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#first element is initial value</span>
<span class='va'>N</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N0</span>
<span class='va'>t</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fl'>0</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='cn'>T</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='va'>rmax</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>/</span><span class='va'>K</span><span class='op'>)</span>
  <span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>=</span><span class='va'>t</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span>
<span class='op'>}</span>
<span class='co'>#make it pretty</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>t<span class='op'>=</span><span class='va'>t</span>,N<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    t        N
1   0 100.0000
2   1 117.9262
3   2 159.7175
4   3 217.3333
5   4 262.0640
6   5 315.7164
7   6 340.4135
8   7 369.8679
9   8 394.5634
10  9 405.0532
11 10 431.7182
12 11 451.1262
13 12 454.4247
14 13 472.5426
15 14 468.2457
16 15 483.4657
17 16 482.6622
18 17 482.5467
19 18 489.3906
20 19 495.3132
21 20 497.2555
22 21 496.7765
23 22 497.2784
24 23 497.5384
25 24 497.7917
26 25 498.2529
27 26 498.3391
28 27 499.3985
29 28 499.4442
30 29 499.3643
31 30 499.6037
32 31 499.6926
33 32 499.6897
34 33 499.7543
35 34 499.8959
36 35 499.9207
37 36 499.9246
38 37 499.9371
39 38 499.9615
40 39 499.9688
41 40 499.9760
42 41 499.9797
43 42 499.9859
44 43 499.9871
45 44 499.9879
46 45 499.9910
47 46 499.9933
48 47 499.9950
49 48 499.9959
50 49 499.9978
51 50 499.9975</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>N</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Population-models1_files/figure-html5/add%20a%20stochastic%20term%20eg%20rmax%20is%20stochastically%20influenced%20by%20environment-2.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#instead of the above approaches we can model growth in terms of F and S directly</span>
<span class='co'>#as Poisson and Binomial processes</span>

<span class='co'>#AGE STRUCTURE</span>
<span class='co'>#Survival rates for four age classes</span>
<span class='va'>S</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>,<span class='fl'>0.65</span>,<span class='fl'>0.85</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='co'>#births for four age classes</span>
<span class='va'>b</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='va'>f</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='va'>S</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,<span class='va'>b</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='va'>S</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,<span class='va'>b</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>*</span><span class='va'>S</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>,<span class='va'>b</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>*</span><span class='va'>S</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>A1</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>S</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='va'>A2</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='va'>S</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='va'>A3</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='va'>S</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>,<span class='va'>S</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>A</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>f</span>,<span class='va'>A1</span>,<span class='va'>A2</span>,<span class='va'>A3</span><span class='op'>)</span>
<span class='va'>A</span>
</code></pre>
</div>
<pre><code>   [,1] [,2] [,3] [,4]
f   0.0 0.65 1.70    0
A1  0.5 0.00 0.00    0
A2  0.0 0.65 0.00    0
A3  0.0 0.00 0.85    0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>years</span><span class='op'>=</span><span class='fl'>50</span>
<span class='co'>#initial abundance vector</span>
<span class='va'>N</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>100</span>,<span class='fl'>200</span>,<span class='fl'>500</span><span class='op'>)</span>
<span class='va'>N</span>
</code></pre>
</div>
<pre><code>[1]  10 100 200 500</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#create empty vectors for age vector, time, population, individual ages, and growth rate</span>
<span class='va'>age</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>t</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>pop</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>age0</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>age1</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>age2</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>age3</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>grow</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='co'>#for loop to simulate population under deterministic conditions</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>y</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>years</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>t</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>y</span><span class='op'>)</span>
  <span class='va'>abund</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span>
  <span class='va'>pop</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>pop</span>,<span class='va'>abund</span><span class='op'>)</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>{</span><span class='va'>age</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>=</span><span class='va'>N</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>/</span><span class='va'>abund</span><span class='op'>}</span>
  <span class='va'>age0</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>age0</span>,<span class='va'>age</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>age1</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>age1</span>,<span class='va'>age</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>age2</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>age2</span>,<span class='va'>age</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>age3</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>age3</span>,<span class='va'>age</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"year"</span>,<span class='va'>y</span>,<span class='st'>"\n"</span><span class='op'>)</span>;
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"Population"</span>,<span class='va'>N</span>,<span class='st'>"\n"</span><span class='op'>)</span>;
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"age structure"</span>,<span class='va'>age</span>,<span class='st'>"\n"</span><span class='op'>)</span>;
  <span class='va'>N</span><span class='op'>=</span><span class='va'>A</span><span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span><span class='va'>N</span>
  
  <span class='va'>grow</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span><span class='op'>(</span><span class='va'>grow</span>,<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>)</span><span class='op'>/</span><span class='va'>abund</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"lambda"</span>,<span class='va'>grow</span><span class='op'>[</span><span class='va'>y</span><span class='op'>]</span>,<span class='st'>"\n"</span><span class='op'>)</span>;
<span class='op'>}</span>
</code></pre>
</div>
<pre><code>year 1 
Population 10 100 200 500 
age structure 0.01234568 0.1234568 0.2469136 0.617284 
lambda 0.7962963 
year 2 
Population 405 5 65 170 
age structure 0.627907 0.007751938 0.1007752 0.2635659 
lambda 0.5810078 
year 3 
Population 113.75 202.5 3.25 55.25 
age structure 0.3035357 0.5403602 0.008672448 0.1474316 
lambda 0.8763509 
year 4 
Population 137.15 56.875 131.625 2.7625 
age structure 0.417615 0.1731816 0.4007917 0.008411677 
lambda 1.455962 
year 5 
Population 260.7312 68.575 36.96875 111.8812 
age structure 0.5452846 0.1434155 0.07731521 0.2339847 
lambda 0.6562362 
year 6 
Population 107.4206 130.3656 44.57375 31.42344 
age structure 0.34234 0.4154637 0.1420526 0.1001437 
lambda 1.073507 
year 7 
Population 160.513 53.71031 84.73766 37.88769 
age structure 0.4765137 0.1594494 0.25156 0.1124769 
lambda 1.087019 
year 8 
Population 178.9657 80.25652 34.9117 72.02701 
age structure 0.4887624 0.2191837 0.09534524 0.1967086 
lambda 0.7724504 
year 9 
Population 111.5166 89.48286 52.16674 29.67495 
age structure 0.394273 0.3163714 0.1844383 0.1049174 
lambda 1.078737 
year 10 
Population 146.8473 55.75832 58.16386 44.34172 
age structure 0.4812911 0.1827475 0.1906317 0.1453297 
lambda 0.9643281 
year 11 
Population 135.1215 73.42365 36.2429 49.43928 
age structure 0.4592418 0.2495474 0.12318 0.1680309 
lambda 0.8681414 
year 12 
Population 109.3383 67.56073 47.72538 30.80647 
age structure 0.4280544 0.2644971 0.1868426 0.1206059 
lambda 1.034322 
year 13 
Population 125.0476 54.66916 43.91448 40.56657 
age structure 0.4733106 0.2069251 0.1662182 0.1535462 
lambda 0.9295142 
year 14 
Population 110.1896 62.52381 35.53495 37.3273 
age structure 0.4486991 0.254601 0.1447006 0.1519992 
lambda 0.9243175 
year 15 
Population 101.0499 55.09478 40.64047 30.20471 
age structure 0.4451736 0.2427191 0.1790409 0.1330663 
lambda 0.994676 
year 16 
Population 104.9004 50.52495 35.81161 34.5444 
age structure 0.4646106 0.2237782 0.1586119 0.1529994 
lambda 0.9276772 
year 17 
Population 93.72095 52.45021 32.84122 30.43987 
age structure 0.4474574 0.2504161 0.1567957 0.1453308 
lambda 0.9490987 
year 18 
Population 89.9227 46.86047 34.09263 27.91503 
age structure 0.4523483 0.2357275 0.1715 0.1404241 
lambda 0.969945 
year 19 
Population 88.41679 44.96135 30.45931 28.97874 
age structure 0.4585548 0.2331824 0.1579707 0.150292 
lambda 0.9352399 
year 20 
Population 81.0057 44.20839 29.22488 25.89041 
age structure 0.4492097 0.2451536 0.1620639 0.1435729 
lambda 0.9565673 
year 21 
Population 78.41775 40.50285 28.73546 24.84115 
age structure 0.454603 0.2348029 0.1665851 0.144009 
lambda 0.9573372 
year 22 
Population 75.17713 39.20887 26.32685 24.42514 
age structure 0.4552382 0.237431 0.1594234 0.1479074 
lambda 0.9428089 
year 23 
Population 70.24142 37.58856 25.48577 22.37782 
age structure 0.4511517 0.2414266 0.1636918 0.1437299 
lambda 0.9568446 
year 24 
Population 67.75837 35.12071 24.43257 21.6629 
age structure 0.4548319 0.2357497 0.164005 0.1454134 
lambda 0.9521032 
year 25 
Population 64.36382 33.87919 22.82846 20.76768 
age structure 0.4537804 0.2388564 0.1609461 0.1464171 
lambda 0.9478161 
year 26 
Population 60.82985 32.18191 22.02147 19.40419 
age structure 0.4524771 0.2393821 0.1638046 0.1443362 
lambda 0.955137 
year 27 
Population 58.35474 30.41493 20.91824 18.71825 
age structure 0.4544544 0.236865 0.1629068 0.1457738 
lambda 0.9505642 
year 28 
Population 55.33072 29.17737 19.7697 17.78051 
age structure 0.4533138 0.2390446 0.1619693 0.1456722 
lambda 0.9504367 
year 29 
Population 52.57379 27.66536 18.96529 16.80425 
age structure 0.4531884 0.2384766 0.1634817 0.1448534 
lambda 0.953492 
year 30 
Population 50.22348 26.28689 17.98248 16.1205 
age structure 0.4540454 0.2376467 0.1625706 0.1457374 
lambda 0.9505184 
year 31 
Population 47.6567 25.11174 17.08648 15.28511 
age structure 0.4532689 0.2388409 0.1625117 0.1453786 
lambda 0.9515323 
year 32 
Population 45.36965 23.82835 16.32263 14.52351 
age structure 0.4534963 0.2381784 0.1631543 0.145171 
lambda 0.9524235 
year 33 
Population 43.2369 22.68482 15.48843 13.87424 
age structure 0.4537669 0.2380749 0.1625495 0.1456087 
lambda 0.950882 
year 34 
Population 41.07546 21.61845 14.74514 13.16516 
age structure 0.4533505 0.2386031 0.1627423 0.1453041 
lambda 0.9518521 
year 35 
Population 39.11872 20.53773 14.05199 12.53337 
age structure 0.4535935 0.2381412 0.1629371 0.1453282 
lambda 0.95187 
year 36 
Population 37.23791 19.55936 13.34953 11.94419 
age structure 0.4536175 0.2382644 0.1626186 0.1454994 
lambda 0.95123 
year 37 
Population 35.40778 18.61896 12.71358 11.3471 
age structure 0.4534377 0.2384373 0.1628122 0.1453127 
lambda 0.9518585 
year 38 
Population 33.71542 17.70389 12.10232 10.80655 
age structure 0.4536021 0.2381854 0.1628228 0.1453896 
lambda 0.9516403 
year 39 
Population 32.08147 16.85771 11.50753 10.28697 
age structure 0.453553 0.2383265 0.1626881 0.1454325 
lambda 0.9514555 
year 40 
Population 30.52031 16.04074 10.95751 9.781399 
age structure 0.4534967 0.2383469 0.162816 0.1453403 
lambda 0.9517802 
year 41 
Population 29.05425 15.26015 10.42648 9.313884 
age structure 0.4535845 0.2382361 0.1627745 0.145405 
lambda 0.951574 
year 42 
Population 27.64411 14.52712 9.9191 8.862507 
age structure 0.4535328 0.2383338 0.162734 0.1453994 
lambda 0.951572 
year 43 
Population 26.3051 13.82206 9.44263 8.431235 
age structure 0.4535282 0.2383071 0.1628011 0.1453636 
lambda 0.9517062 
year 44 
Population 25.03681 13.15255 8.984337 8.026236 
age structure 0.4535659 0.2382711 0.1627599 0.145403 
lambda 0.9515733 
year 45 
Population 23.82253 12.5184 8.549157 7.636687 
age structure 0.4535312 0.2383242 0.1627581 0.1453865 
lambda 0.9516202 
year 46 
Population 22.67053 11.91127 8.136963 7.266784 
age structure 0.4535418 0.2382942 0.1627863 0.1453777 
lambda 0.9516585 
year 47 
Population 21.57516 11.33527 7.742322 6.916418 
age structure 0.4535535 0.2382902 0.1627593 0.1453971 
lambda 0.9515901 
year 48 
Population 20.52987 10.78758 7.367922 6.580974 
age structure 0.453535 0.2383135 0.1627682 0.1453834 
lambda 0.9516339 
year 49 
Population 19.53739 10.26494 7.011927 6.262734 
age structure 0.453546 0.2382928 0.1627766 0.1453847 
lambda 0.9516339 
year 50 
Population 18.59248 9.768697 6.672208 5.960138 
age structure 0.4535468 0.2382985 0.1627625 0.1453922 
lambda 0.9516058 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>pop</span>,xlab<span class='op'>=</span><span class='st'>"t"</span>,ylab<span class='op'>=</span><span class='st'>"N"</span>,main<span class='op'>=</span><span class='st'>"Popsize"</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Population-models1_files/figure-html5/STOCHASTIC%20PROCESS%20ORIENTED%20MODELS-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#savePlot(filename="Popsize",type="png")</span>
<span class='co'>#win.graph()</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>age0</span>,xlab<span class='op'>=</span><span class='st'>"t"</span>,ylab<span class='op'>=</span><span class='st'>"age"</span>,main<span class='op'>=</span><span class='st'>"age_structure"</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>age1</span>,col<span class='op'>=</span><span class='st'>"green"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>age2</span>,col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>age3</span>,col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"top"</span>,<span class='st'>"age0=black, age1=green, age2=red, age3=blue"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Population-models1_files/figure-html5/unnamed-chunk-1-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#savePlot(filename="age_structure",type="png")</span>
<span class='co'>#win.graph()</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t</span>,<span class='va'>grow</span>,xlab<span class='op'>=</span><span class='st'>"t"</span>,ylab<span class='op'>=</span><span class='st'>"lambda"</span>,main<span class='op'>=</span><span class='st'>"popgrowth_age"</span>,type<span class='op'>=</span><span class='st'>"l"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Population-models1_files/figure-html5/unnamed-chunk-2-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#savePlot(filename="popgrowth_age",type="png")</span>
</code></pre>
</div>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
